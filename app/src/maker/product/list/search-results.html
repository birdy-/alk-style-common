<div class="sheet">
    <br>
    <div class="row" ng-hide="products.length == 0 || request.busy">
        <div class="col-sm-4 pagination-block">
            <div class="btn btn-success" ng-if="display.type === 'list'" ng-click="certificate()">
                    <i class="fa fa-certificate"></i> Certifier
            </div>
        </div>
        <div class="col-sm-4 col-sm-offset-4 text-right pagination-block">
            <div class="btn-group">
                <label class="btn btn-success" ng-model="display.type" btn-radio="'preview'">
                    <i class="fa fa-th-large"></i>
                </label>
                <label class="btn btn-success" ng-model="display.type" btn-radio="'list'">
                    <i class="fa fa-th-list"></i>
                </label>
            </div>
            <span class="btn btn-success arrow-prev" ng-class="{'disabled': request.offset <= 0}" ng-click="prev()"><i class="fa fa-arrow-left"></i></span>
            <span class="pagination-text">{{ request.offset }} - {{ request.offset + products.length }}</span>
            <span class="btn btn-success arrow-next" ng-class="{'disabled': request.limit !== products.length}" ng-click="next()">
                <i class="fa fa-arrow-right"></i>
            </span>
        </div>
    </div>

    <!-- Preview view -->
    <div class="row products" ng-hide="request.busy || display.type !== 'preview'">
        <div ng-repeat="product in products | unique:'isIdentifiedBy.0.reference' track by product.isIdentifiedBy.0.reference" class="col-sm-2 product">
            <div class="picture missing-picture" ng-click="show(product, $index)">
                <div class="ratio" ng-style="{'background-image': 'url(' + product.urlPictureOriginal + ')'}"  style="height: 100px;">
                </div>
            </div>
            <div class="name">
                <!-- Use the first ProductReference linked to identify the product -->
                <a ng-click="show(product, $index)">
                    {{ product.namePublicLong || product.nameLegal }}
                </a>
            </div>
            <div class="packaging">
                {{ product.packaging }}
            </div>
            <div class="reference text-center">
                <span class="badge" ng-repeat="reference in product.isIdentifiedBy | limitTo:1" >
                    {{ reference.reference }}
                </span>
            </div>
            <div class="product-icons">
                <span class="label label-success" ng-show="product.isCertified()">
                    <i class="fa fa-check"></i> Certifié
                </span>
            </div>
        </div>
    </div>

    <!-- List view -->
    <div class="row products" ng-hide="request.busy || display.type !== 'list'">
            <table class="table table-bordered">
                <thead class="color-stream-inverse">
                    <tr>
                        <th class="text-center">
                            <input type="checkbox" ng-model="display.allSelected"/>
                        </th>
                        <th class="text-center">EAN</th>
                        <th class="text-center">Nom</th>
                        <th class="text-center">Packaging</th>
                        <th class="text-center">Certifié</th>
                    </tr>
                </thead>
                <tbody>
                    <tr ng-repeat="product in products | unique:'isIdentifiedBy.0.reference' track by product.isIdentifiedBy.0.reference">
                        <td class="text-center">
                            <input type="checkbox" ng-model="product.selected">
                        </td>
                        <td class="text-center">
                            <span class="badge" ng-repeat="reference in product.isIdentifiedBy | limitTo:1" >
                            {{ reference.reference }}
                        </span>
                        </td>
                        <td class="pointer-link" ng-click="show(product, $index)">
                            <a>
                                <div class="picture missing-picture text-center">
                                    <img entity-image entity="product" height="60" width="60">
                                </div>
                                <div class="name">
                                    {{ product.namePublicLong || product.nameLegal }}
                                </div>
                            </a>
                        </td>
                        <td class="text-center">{{ product.packaging }}</td>
                        <td class="text-center">
                            <span class="label label-success" ng-show="product.isCertified()">
                                <i class="fa fa-check"></i> Certifié
                            </span>
                        </td>
                    </tr>
                <tbody>
            </table>
        </div>
    </div>


    <div class="row" ng-if="request.busy">
        <div class="col-sm-12 text-center">
            <br/>
            <br/>
            <br/>
            <i class="fa fa-spinner fa-spin fa-4x"></i>
        </div>
    </div>
    <div class="row" ng-if="!request.busy && products.length == 0">
        <div class="col-sm-12 text-center">
            <br/>
            <br/>
            <br/>
            <h3>Aucun produit trouvé.</h3>
            <small>Vos filtres sont peut-être trop spécifiques, ou vous n'êtes pas autorisé à accéder au produit demandé.</small>
        </div>
    </div>
    <div class="row" ng-hide="products.length == 0 || request.busy">
        <div class="col-sm-4 col-sm-offset-8 text-right pagination-block">
            <span class="btn btn-success arrow-prev" ng-class="{'disabled': request.offset <= 0}" ng-click="prev()"><i class="fa fa-arrow-left"></i></span>
            <span class="pagination-text">{{ request.offset }} - {{ request.offset + products.length }}</span>
            <span class="btn btn-success arrow-next" ng-class="{'disabled': request.limit !== products.length}" ng-click="next()">
                <i class="fa fa-arrow-right"></i>
            </span>
        </div>
    </div>
</div>

